
MODULE surveillance (lumiere, obstacle_reel)
  VAR
    camera : {ON, OFF, ACT};
    telemetre : {ON, OFF, ACT1, ACT2, ACT3};
    sonar : {ON, OFF, ACT1, ACT2};
  DEFINE
    detection_active := (lumiere & camera = ON) | (!lumiere & telemetre = ON & sonar = ON);
    obstacle_detecte := detection_active & obstacle_reel;
  ASSIGN
    init(camera) := OFF;
    init(sonar) := OFF;
    init(telemetre) := OFF;
    next(camera) := case
                      lumiere & (camera = OFF) : ACT;
                      lumiere & (camera = ACT | camera = ON) : ON;
                      !lumiere : OFF;
                    esac;
    next(sonar) := case
                     !lumiere & (sonar = OFF) : ACT1;
                     !lumiere & (sonar = ACT1) : ACT2;
                     !lumiere & (sonar = ACT2 | sonar = ON) : ON;
                     lumiere : OFF;
                   esac;
    next(telemetre) := case
                         !lumiere & (telemetre = OFF) : ACT1;
                         !lumiere & (telemetre = ACT1) : ACT2;
                         !lumiere & (telemetre = ACT2) : ACT3;
                         !lumiere & (telemetre = ACT3 | telemetre = ON) : ON;
                         lumiere : OFF;
                       esac;

MODULE navigation (replanif)
  VAR
    ordre_arret : boolean;
  ASSIGN
    init(ordre_arret) := FALSE;
    next(ordre_arret) := replanif;
    
MODULE guidage (change_liste_wps, avance, obstacle)
  VAR

  ASSIGN

      
MODULE pilotage (ordre_arret)
  VAR

  ASSIGN

MODULE main
  VAR
    surv : surveillance(TRUE, FALSE);
    obstacle : boolean;
  ASSIGN
    obstacle := TRUE;

LTLSPEC
  G (obstacle ->  F surv.obstacle_detecte)
